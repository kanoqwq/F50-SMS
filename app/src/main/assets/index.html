<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="icon" type="image/svg+xml" href="./favicon.webp">
    <title id="TITLE">ZTE-UFI-TOOLS-WEB</title>
    <link rel="manifest" href="/manifest.json">
    <link rel="stylesheet" href="/style/style.css">
    <script src="/script/draglist.js"></script>
</head>

<body id="BG">
    <div class="bg" id="BG_OVERLAY">
        <div class="container">
            <div class="title" onclick="enableTTYD()"
                style="align-self: start;justify-self: start;margin-bottom: 10px;;margin-top: 20px">
                <strong id="MAIN_TITLE">ZTE-UFI管理工具</strong>
                <strong id="MODEL" style="font-size: 14px;"></strong>
            </div>
            <!-- 操作按钮 -->
            <div id="collapseBtn_menu" style="align-self: start;justify-self: start;margin: 6px;margin-top: 0;">
                <!-- <button id="CLPS">功能列表</button> -->
            </div>
            <div class="actions collapse collapse_menu" data-name="close"
                style="flex-shrink: 0;text-align: start;align-self: flex-start">
                <div style="margin: 0 2px;margin-bottom: 10px;" class="collapse_box">
                    <div>
                        <button id="CLEAR" class="btn">登录/退出登录</button>
                        <button id="CHANGEPWD" class="btn" onclick="createToast('请登录','red')">更改密码</button>
                        <button id="REBOOT" class="btn" onclick="createToast('请登录','red')">重启设备</button>
                        <button id="SCHEDULE_REBOOT" class="btn" onclick="createToast('请登录','red')">定时重启</button>
                        <button id="SHUTDOWN" style="display: none;" class="btn"
                            onclick="createToast('请登录','red')">关机</button>
                    </div>
                    <div>
                        <button id="BG_SETTING" class="btn" onclick="createToast('请登录','red')">主题背景</button>
                        <button id="SMS" class="btn">短信收发</button>
                        <button id="DataManagement" class="btn">流量管理</button>
                        <button id="SpeedTestBtn" class="btn" onclick="showModal('#speedTestModal')">内网测速</button>
                        <button id="ClientManagement" class="btn">连接设备管理</button>
                        <button id="WIFIManagement" class="btn">WIFI设置</button>
                        <button id="AT" class="btn" onclick="createToast('请登录','red')">AT指令</button>
                        <button id="ADVANCE" class="btn" onclick="createToast('请登录','red')">高级功能</button>
                        <button id="CECULLAR" class="btn" onclick="createToast('请登录','red')">开启蜂窝数据</button>
                        <button id="ADB" class="btn" onclick="createToast('请登录','red')">开启USB调试</button>
                        <button id="ADB_NET" class="btn" onclick="createToast('请登录','red')">开启网络ADB自启</button>
                        <button id="PERF" class="btn" onclick="createToast('请登录','red')">开启性能模式</button>
                        <button id="LIGHT" class="btn" onclick="createToast('请登录','red')">开启指示灯</button>
                        <button id="SMB" class="btn" onclick="createToast('请登录','red')">开启SMB文件共享</button>
                        <button id="ROAM" class="btn" onclick="createToast('请登录','red')">开启网络漫游</button>
                        <button id="smsForward" class="btn" onclick="createToast('请登录','red')">短信转发</button>
                        <button id="OTA" class="btn" onclick="createToast('请登录','red')">软件更新</button>
                        <select class="select" id="NET_TYPE" onchange="changeNetwork(event)">
                            <option value="WL_AND_5G">5G/4G/3G</option>
                            <option value="LTE_AND_5G">5G NSA</option>
                            <option value="Only_5G">5G SA</option>
                            <option value="WCDMA_AND_LTE">4G/3G</option>
                            <option value="Only_LTE">仅4G</option>
                            <option value="Only_WCDMA">仅3G</option>
                        </select>
                        <select class="select" id="USB_TYPE" onchange="changeUSBNetwork(event)">
                            <option value="0">USB上网:自动</option>
                            <option value="1">RNDIS</option>
                            <option value="2">CDC-ECM</option>
                        </select>
                        <select class="select" id="SIM_CARD_TYPE" style="display: none;"
                            onchange="changeSimCard(event)">
                            <option value="0">SIM卡1</option>
                            <option value="1">SIM卡2</option>
                        </select>
                    </div>
                </div>
            </div>
            <!-- 状态 -->
            <div style="flex-shrink:0;width: 100%;margin-top: 10px;">
                <div class="title" style="margin: 6px 0;">
                    <strong>基本状态</strong>
                    <div style="display: inline-block;" id="collapse_status_btn"></div>
                    <button id="DICTIONARY" class="btn" style="padding: 4px;margin-left: 10px;">管理字段</button>
                    <button id="REFRESH" class="btn" style="padding: 4px;margin-left: 10px;">停止刷新</button>
                </div>
                <div class="collapse" id="collapse_status">
                    <div class="collapse_box">
                        <ul class="deviceList" id="STATUS">
                            <li style="padding-top: 15px;">
                                <strong class="green"
                                    style="margin: 10px auto;margin-top: 0; display: flex;flex-direction: column;padding: 40px;">
                                    <span style="font-size: 50px;" class="spin">🌀</span>
                                    <span style="font-size: 16px;padding-top: 10px;">loading...</span>
                                </strong>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- TTYD -->
            <div id="TTYD" style="display: none;width: 100%;margin-top: 10px;">
                <div class="title" style="margin: 6px 0 ;">
                    <strong>TTYD</strong>
                    <div style="display: inline-block;" id="collapse_ttyd_btn"></div>
                </div>
                <div class="collapse" id="collapse_ttyd">
                    <div class="collapse_box">
                        <ul class="deviceList">
                            <!-- <li style="padding:10px">
                        <iframe src="http://192.168.0.1:1145/"
                            style="border:none;padding:0;margin:0;width:100%;height:400px;border-radius: 10px;overflow: hidden;opacity: .6;"></iframe>
                    </li> -->
                        </ul>
                    </div>
                </div>
            </div>
            <!-- 锁频锁基站 -->
            <div style="width: 100%;flex-shrink: 0;margin-bottom: 40px;margin-top: 10px;">
                <div class="title" style="margin: 6px 0 ;">
                    <strong>🔒 锁定频段</strong>
                    <div style="display: inline-block" id="collapse_lkband_btn"></div>
                </div>
                <div class="collapse" id="collapse_lkband" style="overflow: visible;margin: 10px 0">
                    <div class="collapse_box">
                        <p class="title"><i style="font-size: 12px;">🚀 本设置可以不用重启，更改完成后切换一下网络模式即可 🚀</i></p>
                        <form class="bands" id="bandsForm" onsubmit="submitBandForm(event)">
                            <table class="nice-table">
                                <thead>
                                    <tr>
                                        <th>选择</th>
                                        <th>Band</th>
                                        <th>频率范围 (MHz)</th>
                                        <th>制式</th>
                                        <th>运营商</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><input type="checkbox" data-type="4G" data-band="1"></td>
                                        <td>B1</td>
                                        <td>2100</td>
                                        <td>FDD-LTE</td>
                                        <td>联通/电信</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" data-type="4G" data-band="3"></td>
                                        <td>B3</td>
                                        <td>1800</td>
                                        <td>FDD-LTE</td>
                                        <td>三大运营商</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" data-type="4G" data-band="5"></td>
                                        <td>B5</td>
                                        <td>850</td>
                                        <td>FDD-LTE</td>
                                        <td>电信</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" data-type="4G" data-band="8"></td>
                                        <td>B8</td>
                                        <td>900</td>
                                        <td>FDD-LTE</td>
                                        <td>移动</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" data-type="4G" data-band="34"></td>
                                        <td>B34</td>
                                        <td>2000</td>
                                        <td>TD-LTE</td>
                                        <td>移动</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" data-type="4G" data-band="38"></td>
                                        <td>B38</td>
                                        <td>2600</td>
                                        <td>TD-LTE</td>
                                        <td>移动</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" data-type="4G" data-band="39"></td>
                                        <td>B39</td>
                                        <td>1900</td>
                                        <td>TD-LTE</td>
                                        <td>移动</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" data-type="4G" data-band="40"></td>
                                        <td>B40</td>
                                        <td>2300</td>
                                        <td>TD-LTE</td>
                                        <td>移动</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" data-type="4G" data-band="41"></td>
                                        <td>B41</td>
                                        <td>2500–2690</td>
                                        <td>TD-LTE</td>
                                        <td>移动</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" data-type="5G" data-band="1"></td>
                                        <td>N1</td>
                                        <td>1920–1980 / 2110–2170</td>
                                        <td>FDD</td>
                                        <td>联通/电信</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" data-type="5G" data-band="5"></td>
                                        <td>N5</td>
                                        <td>824–849 / 869–894</td>
                                        <td>FDD</td>
                                        <td>电信</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" data-type="5G" data-band="8"></td>
                                        <td>N8</td>
                                        <td>880–915 / 925–960</td>
                                        <td>FDD</td>
                                        <td>移动</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" data-type="5G" data-band="28"></td>
                                        <td>N28</td>
                                        <td>703–748 / 758–803</td>
                                        <td>FDD</td>
                                        <td>广电/移动</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" data-type="5G" data-band="41"></td>
                                        <td>N41</td>
                                        <td>2515–2675</td>
                                        <td>TDD</td>
                                        <td>移动</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" data-type="5G" data-band="78"></td>
                                        <td>N78</td>
                                        <td>3300–3600</td>
                                        <td>TDD</td>
                                        <td>联通/电信</td>
                                    </tr>
                                </tbody>
                            </table>
                            <button type="submit" class="btn"
                                style="margin-top: 6px;;width: 100%;padding: 8px;font-size: 14px;">锁频段!</button>
                        </form>
                    </div>
                </div>
                <div class="title" style="margin: 6px 0; margin-top: 10px;">
                    <strong>🔒 锁定基站</strong>
                    <div style="display: inline-block;" id="collapse_lkcell_btn"></div>
                </div>
                <div class="collapse" id="collapse_lkcell" style="overflow: visible;margin: 10px 0;margin-top: 20px;">
                    <div class="collapse_box">
                        <p class="title"><i style="font-size: 12px;">🚀 注意，选错基站可能会导致信号不稳定/无信号等问题 🚀</i></p>
                        <div class="title" style="margin: 10px 0 ;margin-top: 20px;"><strong>已锁基站</strong></div>
                        <table class="nice-table" id="LOCKED_CELL_FORM">
                            <thead>
                                <tr>
                                    <th>类型</th>
                                    <th>PCI</th>
                                    <th>频率</th>
                                </tr>
                            </thead>
                            <tbody>

                            </tbody>
                        </table>
                        <div class="title" style="margin: 10px 0 ;"><strong>基站列表</strong></div>
                        <div class="title" id="CURRENT_CELL" style="display: block;margin: 10px 0;font-size:14px">
                            <strong>当前基站信息：</strong>
                        </div>
                        <form id="cellForm" onsubmit="submitCellForm(event)" style="overflow-x: auto;">
                            <table class="nice-table">
                                <thead>
                                    <tr>
                                        <th>频段</th>
                                        <th>频率</th>
                                        <th>PCI</th>
                                        <th>RSRP</th>
                                        <th>RSRQ</th>
                                        <th>SINR</th>
                                    </tr>
                                </thead>
                                <tbody>

                                </tbody>
                            </table>
                            <div style="display: flex;align-items: center; padding: 8px;margin-top: 10px;">
                                <strong>网络选择：</strong>
                                <label style="display: flex;align-items: center;margin-right: 20px;"><span>4G
                                    </span>
                                    <input style="margin: 0 0 0 8px;" type="radio" name="RAT" value="12" />
                                </label>
                                <label style="display: flex;align-items: center;"><span>5G </span>
                                    <input style="margin: 0 0 0 8px;" checked type="radio" name="RAT" value="16" />
                                </label>
                            </div>
                            <div style="margin: 10px;">
                                <input style="padding: 8px; width: 100%" id="PCI" name="PCI" type="text"
                                    placeholder="PCI">
                            </div>
                            <div style="margin: 10px;">
                                <input style="padding: 8px; width: 100%;" id="EARFCN" name="EARFCN" type="text"
                                    placeholder="EARFCN">
                            </div>
                            <button type="submit" class="btn"
                                style="margin-top: 6px;;width: 100%;padding: 8px;font-size: 14px;">锁基站!</button>
                        </form>
                        <button onclick="unlockAllCell()" class="btn"
                            style="margin-top: 6px;;width: 100%;padding: 8px;font-size: 14px;">解除锁定基站</button>
                    </div>
                </div>
            </div>
            <!-- 登录模态框 -->
            <div class="mask" id="tokenModal" style="display: none">
                <div class="modal" style="width: 77%;max-width: 300px;">
                    <div class="title">请输入口令与密码</div>
                    <div class="title" style="margin: 10px 0;">
                        <p style="font-size: 12px;margin: 0;">
                            <i>
                                注：请在UFI-TOOLS_WEB
                                <br>后台App查看口令(默认为admin)
                                <br>密码为官方WEB管理密码
                                <br>如果忘记了密码,请重置设备或联系作者
                            </i>
                        </p>
                    </div>
                    <div class="content"
                        style="padding: 15px 4px 0 4px;display: flex;flex-direction: column;align-items: center;">
                        <input id="TOKEN" placeholder="请在后台App查看" type="password"
                            style="width: 100%;text-indent: .5em;margin:0 4px;margin-bottom: 10px;height: 30px;">
                        <input id="tokenInput" placeholder="设备的WEB管理密码" type="password"
                            style="width: 100%;text-indent: .5em; margin:0 4px;margin-bottom: 20px;height: 30px;">
                    </div>
                    <div class="btn" style="text-align: right;">
                        <button onclick="onTokenConfirm()">确认</button>
                        <button onclick="closeModal('#tokenModal')">取消</button>
                    </div>
                </div>
            </div>
            <!-- 短信模态框 -->
            <div class="modal h100" id="smsList" style="display: none;">
                <div class="title" style="margin-bottom: 6px;">短信列表</div>
                <div class="action"
                    style="margin-top: 10px;background-color: #00ffdd17;box-shadow: 0 0 10px 0 ##00ffdd36;">
                    <span>收件人：</span>
                    <input id="PhoneInput" type="number" style="flex: 1;margin-right: 6px"></input>
                </div>
                <div class="content" id="content" style="flex: 1;">
                    <ul id="sms-list">
                    </ul>
                </div>
                <div class="action" style="background-color: #00ffdd17;box-shadow: 0 0 10px 0 ##00ffdd36;">
                    <input id="SMSInput" type="text" style="flex: 1;margin-right: 6px"></input>
                    <div class="btn"
                        style="height: 100%;min-width: 103px;display: flex;justify-content: center;align-items: center;">
                        <button onclick="sendSMS()" style="margin-right: 6px;height: 100%;">发送</button>
                        <button onclick="closeModal('#smsList')" style="height: 100%;">关闭</button>
                    </div>
                </div>
            </div>
            <!-- 状态管理模态框 -->
            <div id="dictionaryModal" class="modal" style="display: none;width: 90%;max-width: 400px;">
                <div class="title">状态显示/隐藏</div>
                <p style="font-size: 12px;"><i>注：设备不支持/为空的状态无论是否勾选也不会显示</i></p>
                <div class="content" id="DIC_LIST" style="
                overflow-y: scroll;
                max-height:400px;
                padding-top: 15px;
                margin-bottom: 10px;
                display: flex;
                flex-direction: column;
                align-items: start;
                ">
                    <!-- 在这里管理字段显示 -->
                    <div class="title" style="margin: 10px 0;">基本状态</div>
                    <ul class="drag" id="draggable_status">
                        <li draggable="true"> <label><input type="checkbox" data-name="network_type">蜂窝状态</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="QORS_MESSAGE">QCI等级</label></li>
                        <li draggable="true"> <label><input type="checkbox"
                                    data-name="wifi_access_sta_num">WIFI设备数</label>
                        </li>
                        <li draggable="true"> <label><input type="checkbox" data-name="battery">剩余电量</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="rssi">蜂窝信号强度</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="cpu_temp">CPU温度</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="cpu_usage">CPU使用率</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="mem_usage">内存使用率</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="realtime_time">连接时长</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="monthly_tx_bytes">流量使用情况</label>
                        </li>
                        <li draggable="true"> <label><input type="checkbox" data-name="daily_data">当日流量</label></li>
                        <li draggable="true"> <label><input type="checkbox"
                                    data-name="internal_available_storage">内置存储</label></li>
                        <li draggable="true"> <label><input type="checkbox"
                                    data-name="external_available_storage">SD卡</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="realtime_rx_thrpt">实时网速</label>
                        </li>
                    </ul>

                    <div class="title" style="margin: 10px 0;">信号参数</div>
                    <ul class="drag" id="draggable_signal">
                        <li draggable="true"> <label><input type="checkbox" data-name="Z5g_rsrp">5G接收功率</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="Nr_snr">5G SINR</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="Nr_bands">5G 注册频段</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="Nr_fcn">5G 频点</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="Nr_bands_widths">5G 频宽</label>
                        </li>
                        <li draggable="true"> <label><input type="checkbox" data-name="Nr_pci">5G PCI</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="nr_rsrq">5G RSRQ</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="nr_rssi">5G RSSI</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="Nr_cell_id">5G 基站ID</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="lte_rsrp">4G接收功率</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="Lte_snr">4G SINR</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="Lte_bands">4G 注册频段</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="Lte_fcn">4G 频点</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="Lte_bands_widths">4G 频宽</label>
                        </li>
                        <li draggable="true"> <label><input type="checkbox" data-name="Lte_pci">4G PCI</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="lte_rsrq">4G RSRQ</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="lte_rssi">4G RSSI</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="Lte_cell_id">4G 基站ID</label></li>
                    </ul>
                    <div class="title" style="margin: 10px 0;">设备属性</div>
                    <ul class="drag" id="draggable_props">
                        <li draggable="true"> <label><input type="checkbox" data-name="model">设备型号</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="cr_version">版本号</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="iccid">ICCID</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="imei">IMEI</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="imsi">IMSI</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="ipv6_wan_ipaddr">IPV6地址</label>
                        </li>
                        <li draggable="true"> <label><input type="checkbox" data-name="lan_ipaddr">本地网关</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="mac_address">MAC地址</label></li>
                        <li draggable="true"> <label><input type="checkbox" data-name="msisdn">手机号</label></li>
                    </ul>
                </div>
                <div class="btn" style="text-align: right;">
                    <button onclick="resetShowList(event)">重置(全选)</button>
                    <button onclick="closeModal('#dictionaryModal')">关闭</button>
                </div>
            </div>
            <!-- 流量管理模态框 -->
            <div class="mask" id="DataManagementModal" style="display: none">
                <div class="modal">
                    <div class="title">流量管理</div>
                    <form onsubmit="handleDataManagementFormSubmit(event)" id="DataManagementForm">
                        <div class="content" id="DATA_MANAGE_LIST" style="
                        overflow-y: scroll;
                        padding: 15px;
                        width: 66vw;
                        max-width: 400px;">
                            <div class="item">
                                <label style="display: flex;align-items: center;">启用流量管理？<input checked type="checkbox"
                                        name="data_volume_limit_switch"></label>
                            </div>
                            <div class="item">
                                <label style="display: flex;align-items: center;">流量清零？<input checked type="checkbox"
                                        name="wan_auto_clear_flow_data_switch"></label>
                            </div>
                            <div class="item" style="display: flex;">
                                <span style="font-size: 14px;">套餐形式：</span>
                                <label for="for_data" style="display: flex;align-items: center;">
                                    <span style="margin-right: 6px;">流量 </span><input id="for_data" style="margin: 0;"
                                        type="radio" checked name="data_volume_limit_unit">
                                </label>
                                <!-- <label for="for_time">
                                时间 <input id="for_time" type="radio" name="data_volume_limit_unit">
                            </label> -->
                            </div>
                            <div class="item">
                                <label style="
                                display: flex;
                                align-items: center;
                            ">清零日期：<input style="flex: 1;width: 100%;" name="traffic_clear_date" value="1"
                                        type="number" max="31" min="1" maxlength="2" placeholder="清零日期(1-31)"></label>
                            </div>
                            <div class="item">
                                <label style="
                                display: flex;
                                align-items: center;
                            ">提醒阈值：<input style="flex: 1;width: 100%;" name="data_volume_alert_percent" value="80"
                                        type="number" maxlength="3" min="0" max="100"
                                        placeholder="提醒阈值(0-100%)"></label>
                            </div>
                            <div class="item">
                                <div style="display: flex;align-items: center">
                                    <span>流量套餐：</span>
                                    <input style="flex:1;height: 100%;width: 100%;" type="text"
                                        name="data_volume_limit_size" value="100" placeholder="流量套餐">
                                    <select class="select" style="padding: 4px; margin-left: 6px;" value="1024"
                                        name="data_volume_limit_type">
                                        <option data-value="1" value="1">MB</option>
                                        <option data-value="1024" value="1024">GB</option>
                                        <option data-value="1048576" value="1048576">TB</option>
                                    </select>
                                </div>
                            </div>
                            <div class="item">
                                <div style="display: flex;align-items: center;">
                                    <span>已用流量：</span>
                                    <input style="flex:1;height: 100%;width: 100%;" type="text"
                                        name="data_volume_used_size" placeholder="已用流量" value="114">
                                    <select class="select" style="padding: 4px; margin-left: 6px;" value="1024"
                                        name="data_volume_used_type">
                                        <option data-value="1" value="1">MB</option>
                                        <option data-value="1024" value="1024">GB</option>
                                        <option data-value="1048576" value="1048576">TB</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="btn" style="text-align: right;">
                            <button type="submit">提交</button>
                            <button type="button" onclick="closeModal('#DataManagementModal')">关闭</button>
                        </div>
                    </form>
                </div>
            </div>
            <!-- WIFI设置模态框 -->
            <div class="mask" id="WIFIManagementModal" style="display: none">
                <div class="modal">
                    <div class="title" style="margin-bottom: 4px;">WIFI设置</div>
                    <form onsubmit="handleWIFIManagementFormSubmit(event)" id="WIFIManagementForm">
                        <div class="content" style="
                        overflow-y: scroll;
                        padding: 10px;
                        width: 66vw;
                        max-width: 400px;">
                            <input style="display: none;" type="text" name="AccessPointIndex" value="0">
                            <input style="display: none;" type="text" name="ApIsolate" value="0">
                            <input style="display: none;" type="text" name="ChipIndex" value="0">
                            <div class="dash-border-round"
                                style="padding-top: 6px;padding-bottom: 6px;display: flex;justify-content: space-between;align-items: center;">
                                <select class="select" id="WIFI_SWITCH" onchange="changeWIFISwitch(event)">
                                    <option value="0">WIFI:关闭</option>
                                    <option value="chip1">WIFI:2.4G</option>
                                    <option value="chip2">WIFI:5G</option>
                                </select>
                                <span style="display: inline; font-size: 10px; text-align: right;">此选项即时更改无需确认。</span>
                            </div>
                            <div class="dash-border-round">
                                <div class="item">
                                    <label style="
                                display: flex;
                                align-items: center;
                            "><span class="label-name">SSID：</span><input style="flex: 1;width: 100%;" name="SSID"
                                            value="1" type="text" placeholder="请输入SSID"></label>
                                </div>
                                <div class="item">
                                    <label style="display: flex;align-items: center;"><span
                                            class="label-name">广播SSID：</span><input checked type="checkbox"
                                            name="ApBroadcastDisabled"></label>
                                </div>
                            </div>
                            <div class="dash-border-round">
                                <div class="item">
                                    <label style="
                                display: flex;
                                align-items: center;
                            ">
                                        <span class="label-name">安全模式：</span>
                                        <select class="select" id="WIFI_ENC_MODE"
                                            onchange="handleWifiEncodeChange(event)"
                                            style="width: 100%;flex: 1;padding: 4px; margin-left: 6px;text-align: left;"
                                            value="OPEN" name="AuthMode">
                                            <option data-value="OPEN" value="OPEN">OPEN</option>
                                            <option data-value="WPA2PSK" value="WPA2PSK">WPA2(AES)-PSK</option>
                                            <option data-value="WPA3PSK" value="WPA3PSK">WPA3-PSK</option>
                                            <option data-value="WPA2PSKWPA3PSK" value="WPA2PSKWPA3PSK">WPA2-PSK/WPA3-PSK
                                            </option>
                                        </select>
                                    </label>
                                </div>
                            </div>
                            <div id="WIFI_FORM_SHOWABLE">
                                <div class="dash-border-round">
                                    <div class="item">
                                        <label style="
                                display: flex;
                                align-items: center;
                            "><span class="label-name">密码：</span><input id="WIFI_PASSWORD" style="flex: 1;width: 100%;"
                                                name="Password" value="" type="password" placeholder="密码最短为8位"></label>
                                    </div>
                                    <div class="item">
                                        <label onclick="handleShowPassword(event)"
                                            style="display: flex;align-items: center;"><span
                                                class="label-name">显示密码：</span><input type="checkbox"></label>
                                    </div>
                                </div>
                                <div class="dash-border-round">
                                    <div class="item">
                                        <label style="
                                display: flex;
                                align-items: center;
                            "><span class="label-name">最大接入：</span><input style="flex: 1;width: 100%;"
                                                name="ApMaxStationNumber" value="10" type="number" min="1" maxlength="8"
                                                placeholder="客户端最大接入"></label>
                                    </div>
                                </div>
                            </div>
                            <div class="dash-border-round" style="text-align: center;">
                                <div>二维码</div>
                                <div style="text-align: center">
                                    <img id="QRCodeImg" style="border-radius: 20px;" src="" alt="">
                                </div>
                            </div>
                        </div>
                        <div class="btn" style="text-align: right;margin-top: 6px;">
                            <button type="submit">提交</button>
                            <button type="button" onclick="closeModal('#WIFIManagementModal')">关闭</button>
                        </div>
                    </form>
                </div>
            </div>
            <!-- 连接设备管理模态框 -->
            <div class="mask" id="ClientManagementModal" style="display: none">
                <div class="modal" style="width: 90%;max-width: 600px; display: flex;flex-direction: column;">
                    <div class="title" style="margin-bottom: 4px;">连接设备管理</div>
                    <ul class="deviceList" style="flex: 1; overflow-y: auto;">
                        <p style="display: flex;justify-content: space-between;">接入设备 <button
                                style="margin-right: 10px;" class="btn"
                                onclick="initClientManagementModal()">刷新</button></p>
                        <li id="CONN_CLIENT_LIST"
                            style="padding:0 10px;box-sizing: border-box;width: 100%;overflow: hidden;;">

                        </li>
                        <p>黑名单</p>
                        <li id="BLACK_CLIENT_LIST"
                            style="padding:0 10px;box-sizing: border-box;width: 100%;overflow: hidden;;">
                        </li>
                    </ul>
                    <div class="btn" style="text-align: right;margin-top: 6px;">
                        <!-- <button type="submit">提交</button> -->
                        <button type="button" onclick="closeClientManager()">关闭</button>
                    </div>
                </div>
            </div>
            <!-- 设置背景模态框 -->
            <div class="modal" id="bgSettingModal"
                style="width: 90%;max-width: 400px; display: flex;flex-direction: column;display: none;">
                <div class="title" style="margin-bottom: 4px;">主题背景设置</div>
                <div style="text-align: left ;">
                    <p style="font-size: 14px"><label
                            style="display: flex;align-items: center;"><span>启用背景图片？</span><input type="checkbox"
                                id="isCheckedBG"></label></p>
                    <p style="font-size: 14px;">图片网址：
                        <input placeholder="输入网址" type="text" id="BG_INPUT"
                            style="width: 100%;max-width: 200px;padding: 6px 10px;margin: 4px 0;">
                    </p>
                    <label><input id="fileUploader" type="file" style="display: none;"
                            onchange="handleFileUpload(event)">
                        <button style="width: 100%;"
                            onclick="document.querySelector('#fileUploader').click()">上传图片(3MB内)</button></label>
                </div>
                <div style="text-align: left;width: 100%;font-size: 14px;">
                    <p>字体颜色(黑-白)</p>
                    <input id="textColorEl" oninput="updateTextColor(event)"
                        style="width: 100%;margin-left: 0;margin-right: 0;" min="0" max="100" type="range">
                    <p>主题颜色(颜色、饱和度、亮度)</p>
                    <div class="color-panel">
                    </div>
                    <input id="colorEl" oninput="getColorByPercent(event)"
                        style="width: 100%;margin-left: 0;margin-right: 0;" min="0" max="100" type="range">
                    <input id="saturationEl" oninput="getSaturationByPercent(event)"
                        style="width: 100%;margin-left: 0;margin-right: 0;" min="0" max="100" type="range">
                    <input id="brightEl" oninput="getValueByPercent(event)"
                        style="width: 100%;margin-left: 0;margin-right: 0;" min="0" max="100" type="range">
                    <p>背景透明度</p>
                    <input id="opacityEl" oninput="getOpacityByPercent(event)"
                        style="width: 100%;margin-left: 0;margin-right: 0;" type="range" min="0" max="100">
                </div>
                <div class="btn" style="text-align: right;margin-top: 6px;">
                    <button type="button" onclick="resetTheme(event)">重置主题</button>
                    <button type="button" onclick="handleSubmitBg(event)">提交</button>
                    <button type="button" onclick="closeModal('#bgSettingModal')">关闭</button>
                </div>
            </div>
            <!-- 定时重启模态框 -->
            <div class="mask" id="scheduleRebootModal" style="display: none">
                <div class="modal" style="width: 90%;max-width: 400px; display: flex;flex-direction: column;">
                    <form id="scheduleRebootForm" onsubmit="handleScheduleRebootFormSubmit(event)">
                        <div class="title" style="margin-bottom: 4px;">每日定时重启</div>
                        <div style="text-align: left;">
                            <p><label>启用每日定时重启？<input id="SCHEDULE_ENABLED" type="checkbox"
                                        name="restart_schedule_switch"></label></p>
                            <p>每日重启时间：<input id="SCHEDULE_TIME" name="restart_time" placeholder="00:00" type="text"
                                    id="BG_INPUT" style="width: 100%;max-width: 60px;padding: 6px 10px;margin: 4px 0;">
                            </p>
                        </div>
                        <div class="btn" style="text-align: right;margin-top: 6px;">
                            <button type="submit">提交</button>
                            <button type="button" onclick="closeModal('#scheduleRebootModal')">关闭</button>
                        </div>
                    </form>
                </div>
            </div>
            <!-- TTYD模态框 -->
            <div class="mask" id="TTYDModal" style="display: none">
                <div class="modal" style="width: 90%;max-width: 400px; display: flex;flex-direction: column;">
                    <form id="TTYDForm" onsubmit="handleTTYDFormSubmit(event)">
                        <div class="title" style="margin-bottom: 4px;">TTYD</div>
                        <div style="text-align: left;">
                            <p>TTYD端口号：<input name="ttyd_port" placeholder="1145" type="number" id="TTYD_INPUT"
                                    style="width: 100%;max-width: 100px;padding: 6px 10px;margin: 4px 0;">
                            </p>
                        </div>
                        <div class="btn" style="text-align: right;margin-top: 6px;">
                            <button type="submit">提交</button>
                            <button type="button" onclick="closeModal('#TTYDModal')">关闭</button>
                        </div>
                    </form>
                </div>
            </div>
            <!-- AT指令模态框 -->
            <div class="mask" id="ATModal" style="display: none">
                <div class="modal" style="width: 90%;max-width: 800px; display: flex;flex-direction: column;">
                    <div class="title" style="margin-bottom: 4px;">AT指令</div>
                    <div class="title" style="margin-bottom: 4px;font-size: 12px;">
                        <i style="color: yellow;">⚠️警告：执行自定义AT属于高级操作，请务必确保输入准确无误。因执行指令所引发的任何后果，需由您自行承担。</i>
                    </div>
                    <p style="font-size: 14px;margin-bottom: 0;margin-top:10px;">自定义AT指令</p>
                    <div style="margin: 10px 0;">
                        <span style="font-size: 14px;">AT执行槽位：</span>
                        <select class="select" id="AT_SLOT" style="width: 100%;max-width: 100px;padding: 6px 10px;"
                            value="0">
                            <option data-value="0" value="0">0</option>
                            <option data-value="1" value="1">1</option>
                            </option>
                        </select>
                    </div>
                    <div style="text-align: left">
                        <div style="margin-bottom: 0;">
                            <input name="at_text" placeholder="AT+开头的指令" type="text" id="AT_INPUT"
                                style="width: 100%;max-width: 200px;padding: 6px 10px;margin: 4px 0;">
                            <button class="btn"
                                onclick="disableButtonWhenExecuteFunc(event,handleATFormSubmit)">GO</button>
                        </div>
                        <div style="margin-top: 2px;margin-bottom: 10px;">
                            <div style="display: flex;flex-wrap: wrap; gap: 10px;">
                                <div>
                                    <p style="font-size: 14px;margin-bottom: 10px;margin-top: 8px;">快捷指令</p>
                                    <button class="btn"
                                        onclick="disableButtonWhenExecuteFunc(event,handleQosAT)">签约速率</button>
                                    <button class="btn"
                                        onclick="disableButtonWhenExecuteFunc(event,()=>handleAT('AT+CGSN'))">IMEI</button>
                                    <button class="btn"
                                        onclick="disableButtonWhenExecuteFunc(event,()=>handleAT('AT+CGMR'))">基带信息</button>
                                    <button class="btn" style="margin-top: 6px;"
                                        onclick="disableButtonWhenExecuteFunc(event,()=>handleAT('AT+CIMI'))">IMSI</button>
                                    <button class="btn" style="margin-top: 6px;"
                                        onclick="disableButtonWhenExecuteFunc(event,()=>inputIMEIAT())">填入改串指令</button>
                                </div>
                            </div>
                        </div>
                        <div class="title" style="margin-top: 14px;">执行结果</div>
                        <p id="AT_RESULT" style="margin:20px 0;margin-top: 14px;; font-size: 14px;width: 100%;">
                            <!-- +CGEQOSRDP: 1,6,0,0,0,0,1000000,300000 -->
                        </p>
                    </div>
                    <div class="btn" style="text-align: right;margin-top: 6px;">
                        <button type="button" onclick="closeModal('#ATModal')">关闭</button>
                    </div>
                </div>
            </div>
            <!-- 高级功能模态框 -->
            <div class="mask" id="advanceModal" style="display: none">
                <div class="modal" style="width: 90%;max-width: 800px; display: flex;flex-direction: column;">
                    <div class="title" style="margin-bottom: 4px;">高级功能</div>
                    <div class="content" style="text-align: left;max-height: 500px;">
                        <div class="title" style="margin-bottom: 4px;font-size: 12px;">
                            <b style="color: red;"><i>⚠️
                                    警告：此功能适合有一定动手能力或对设备了解较多的玩机用户使用。普通用户请勿轻易尝试，否则可能会导致设备异常、数据丢失或无法恢复的问题。</i></b>
                        </div>

                        <div style="margin-top: 2px;margin-bottom: 10px;">
                            <div style="display: flex;flex-wrap: wrap; gap: 10px;">
                                <div>
                                    <div class="title" style="font-size: 12px;margin-bottom: 10px;">
                                        <div>
                                            <i>TTYD端口为1146(三击标题区域可更改)</i><br>
                                            <i class="user_select">如去除高级功能报错，可以在TTYD上执行 sh
                                                /sdcard/unlock_samba.sh 重启生效</i><br>
                                            <i><br>添加高级功能包括:<br>
                                                1.优化Samba目录(添加sd卡目录，设备根目录)<br>
                                                2.添加TTYD，自带RootShell<br>
                                                3.默认阻止官方后台 TTYD 网络ADB SMB 的ipv6访问，提升安全性<br>
                                                4.添加定时脚本(开机执行一次，之后30s左右定时执行一次，脚本在内部存储目录下ufi_tools_boot.sh)<br>
                                                <span style="color: pink;">(感谢酷安 @QuTick @AiCherub @atwat 提供的思路)</span>
                                            </i>
                                        </div>
                                    </div>
                                    <div style="font-size: 12px;margin: 8px 0;" class="adb_status title"></div>
                                    <div style="display: flex;gap: 10px;flex-wrap: wrap;">
                                        <button class="btn"
                                            onclick="disableButtonWhenExecuteFunc(event,()=>handleSambaPath())">添加高级功能</button>
                                        <button class="btn"
                                            onclick="disableButtonWhenExecuteFunc(event,()=>handleSambaPath('0'))">移除高级功能(重启生效)</button>
                                        <button class="btn"
                                            onclick="disableButtonWhenExecuteFunc(event,handleShell)">一键执行shell脚本<br>(脚本需在/sdcard/one_click_shell.sh)</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="title" style="margin-top: 14px;">执行结果</div>
                        <p id="AD_RESULT" style="margin:20px 0;margin-top: 14px;; font-size: 14px;width: 100%;">
                        </p>
                    </div>
                    <div class="btn" style="text-align: right;margin-top: 6px;">
                        <button type="button" onclick="closeModal('#advanceModal')">关闭</button>
                    </div>
                </div>
            </div>
            <!-- 更改密码模态框 -->
            <div class="mask" id="changePassModal" style="display: none">
                <div class="modal">
                    <div class="title">更改密码(中兴WEB密码)</div>
                    <form onsubmit="handleChangePassword(event)" id="changePassForm">
                        <div class="content" style="
                        overflow-y: scroll;
                        padding: 15px;
                        width: 66vw;
                        max-width: 400px;">
                            <div class="item" style="margin: 10px auto;">
                                <label style="
                                display: flex;
                                align-items: center;
                            ">旧的密码：<input style="flex: 1;padding: 4px 6px;width: 100%;" name="oldPassword"
                                        type="password" placeholder="旧密码"></label>
                            </div>
                            <div class="item" style="margin: 10px auto;">
                                <label style="
                                display: flex;
                                align-items: center;
                            ">新的密码：<input style="flex: 1;padding: 4px 6px;width: 100%;" name="newPassword"
                                        type="password" placeholder="新密码"></label>
                            </div>
                            <div class="item" style="margin: 10px auto;">
                                <label style="
                                display: flex;
                                align-items: center;
                            ">确认密码：<input style="flex: 1;padding: 4px 6px;width: 100%;" name="confirmPassword"
                                        type="password" placeholder="确认密码"></label>
                            </div>
                        </div>
                        <div class="btn" style="text-align: right;">
                            <button type="submit">提交</button>
                            <button type="button" onclick="onCloseChangePassForm()">关闭</button>
                        </div>
                    </form>
                </div>
            </div>
            <!-- 网络测速模态框 -->
            <div class="modal" id="speedTestModal" style="display: none">
                <div class="title">内网测速</div>

                <div class="content" style="
                    overflow-y: scroll;
                    padding: 15px;
                    width: 66vw;
                    max-width: 400px;">
                    <div class="item" style="margin: 10px auto;">
                        <label style="
                        display: flex;
                        font-size: 14px;
                        align-items: center;
                    ">块大小(1MB 最大 1024)：<input style="flex: 1;padding: 4px 6px;width: 100%;" value="500" id="ckSize"
                                type="number" max="1024" placeholder=""></label>
                    </div>
                    <div class="speedtest" id="speedtestResult">准备就绪</div>
                </div>
                <div class="btn" style="text-align: right;">
                    <button id="startSpeedBtn" onclick="startTest(event)">开始测速</button>
                    <button id="loopMode" onclick="handleLoopMode(event)">循环测速</button>
                    <button type="button" onclick="closeModal('#speedTestModal')">关闭</button>
                </div>
            </div>
            <!-- 版本更新模态框 -->
            <div class="mask" id="updateSoftwareModal" style="display: none;">
                <div class="modal" style="
                    width: 90%;
                    max-width: 800px;
                ">
                    <div class="title">UFI-TOOLS 软件更新</div>
                    <div style="font-size: 12px;margin-top: 10px;" class="adb_status title"></div>
                    <div class="title" style="font-size: 10px;margin-top: 10px;">
                        <div>
                            <i>软件更新功能需要启用网络ADB调试功能，没有启用无法使用 ”一键更新“ 功能，可以点击 "下载安装包" 自行下载安装，如果更新失败，可以关闭窗口再试</i><br>
                            <i>使用有线网络的用户，请暂时关掉"网络ADB自启"开关，否则更新完成之后会断网</i>
                        </div>
                    </div>
                    <div class="content" style="
                        overflow-y: scroll;
                        margin: 15px 0;
                        max-width: 400px;">
                        <div class="speedtest" style="font-size: 12px;" id="OTATextContent">正在检查更新...</div>
                        <div class="speedtest" style="font-size: 12px;margin-top: 10px;" id="ChangelogTextContent"></div>
                    </div>
                    <div class="btn" style="text-align: right;">
                        <button id="doUpdate">一键更新</button>
                        <button id="downloadAPK">下载安装包</button>
                        <button id="closeUpdateBtn" type="button"
                            onclick="closeModal('#updateSoftwareModal')">关闭</button>
                    </div>
                </div>
            </div>
            <!-- 短信转发模态框 -->
            <div class="mask" id="smsForwardModal" style="display: none">
                <div class="modal">
                    <div class="title">短信转发(Beta)</div>
                    <div class="title" style="margin-top: 10px; margin-bottom: 0px;font-size: 12px;">
                        <i>目前只有SMTP邮件转发形式，其他转发方式：comming s∞n（</i>
                    </div>
                    <form onsubmit="handleSmsForwardForm(event)" id="smsForwardForm">
                        <div class="content" style="
                        overflow-y: scroll;
                        padding: 15px;
                        width: 66vw;
                        max-width: 400px;">
                            <div class="item" style="margin: 10px auto;">
                                <label style="
                                display: flex;
                                align-items: center;
                            ">主机：<input style="flex: 1;padding: 4px 6px;width: 100%;" id="smtp_host" name="smtp_host" type="text"
                                        placeholder="SMTP地址"></label>
                            </div>
                            <div class="item" style="margin: 10px auto;">
                                <label style="
                                display: flex;
                                align-items: center;
                            ">端口：<input style="flex: 1;padding: 4px 6px;width: 100%;" id="smtp_port" name="smtp_port" type="number"
                                        placeholder="SMTP端口号"></label>
                            </div>
                            <div class="item" style="margin: 10px auto;">
                                <label style="
                                display: flex;
                                align-items: center;
                            ">用户：<input style="flex: 1;padding: 4px 6px;width: 100%;" id="smtp_username" name="smtp_username"
                                        type="text" placeholder="SMTP用户名"></label>
                            </div>
                            <div class="item" style="margin: 10px auto;">
                                <label style="
                                display: flex;
                                align-items: center;
                            ">密码：<input style="flex: 1;padding: 4px 6px;width: 100%;" id="smtp_password" name="smtp_password"
                                        type="password" placeholder="SMTP密码"></label>
                            </div>
                            <div class="item" style="margin: 10px auto;">
                                <label style="
                                display: flex;
                                align-items: center;
                            ">发给：<input style="flex: 1;padding: 4px 6px;width: 100%;" id="smtp_to" name="smtp_to"
                                        type="email" placeholder="你要转发给谁呢？"></label>
                            </div>
                        </div>
                        <div class="btn" style="text-align: right;">
                            <button type="submit">提交</button>
                            <button type="button" onclick="closeModal('#smsForwardModal')">关闭</button>
                        </div>
                    </form>
                </div>
            </div>
            <!-- ❤️ -->
            <div class="mask" id="payModal" style="display: none" onclick="handleClosePayModal(event)">
                <div class="modal">
                    <div class="title">打赏作者</div>
                    <div class="title" style="display: flex;align-items: center;margin-top: 10px;font-size: 12px;">
                        <div>
                            <p style="margin: 0; font-style: italic;">开发不易，打赏随意～</p>
                            <p style="margin: 0; font-style: italic;">點擊即可讓黑奴幹活（bushi）</p>
                            <p style="margin: 0; font-style: italic;">长按赞赏码可保存为图片</p>
                        </div>
                        <img style="max-width: 80px;flex:1; animation: a 5s infinite ease-in-out;border-radius: 8px;"
                            src="https://kanokano.cn/wp-content/uploads/2025/05/BFEE3DCE16FE04E6EF4EC52396E618B1.webp"
                            onerror="this.onerror=null; this.src='/img/hn.webp'" alt="">
                    </div>
                    <div class="content"
                        style="overflow-y: hidden;padding: 15px;width: 66vw;max-width: 400px;max-height:fit-content;">
                        <div class="item" style="margin: 10px auto;">
                            <img style="width: 100%;border-radius: 20px;"
                                src="https://kanokano.cn/wp-content/uploads/2025/05/QQ20250506-140557.webp"
                                onerror="this.onerror=null; this.src='/img/zsm.webp'" alt="">
                        </div>
                    </div>
                    <div class="btn" style="text-align: right;">
                        <button type="button" onclick="onClosePayModal()">不再显示</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer">
        <p>Made by <a href="https://github.com/kanoqwq/UFI-TOOLS" target="_blank">MiniKano</a> with love ❤️ &nbsp;<a
                href="javascript:;" onclick="showModal('#payModal')">打赏作者</a></p>
    </div>
    <div id="toastContainer"></div>
    <script src="/script/utils.js"></script>
    <script src="/script/theme.js"></script>
    <script src="/script/requests.js"></script>
    <script src="/script/preload.js"></script>
    <script src="/script/main.js"></script>
</body>

</html>